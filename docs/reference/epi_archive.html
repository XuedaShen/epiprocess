<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Archive (data version history) for an <code>epi_df</code> object — epi_archive • epiprocess</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Archive (data version history) for an <code>epi_df</code> object — epi_archive" />
<meta property="og:description" content="Archive (data version history) for an epi_df object
Archive (data version history) for an epi_df object" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epiprocess</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/epiprocess.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/slide.html">1. Slide a computation over signal values</a>
    </li>
    <li>
      <a href="../articles/pct_change.html">2. Compute percentage change over time</a>
    </li>
    <li>
      <a href="../articles/derivative.html">3. Estimate derivatives of signals</a>
    </li>
    <li>
      <a href="../articles/correlation.html">4. Correlate signals over space and time</a>
    </li>
    <li>
      <a href="../articles/aggregation.html">5. Aggregate signals over space and time</a>
    </li>
    <li>
      <a href="../articles/outliers.html">6. Detect and correct outliers in signals</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cmu-delphi/epiprocess/tree/main/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Archive (data version history) for an <code>epi_df</code> object</h1>
    <small class="dont-index">Source: <a href='https://github.com/cmu-delphi/epiprocess/blob/main/R/epi_archive.R'><code>R/epi_archive.R</code></a></small>
    <div class="hidden name"><code>epi_archive.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Archive (data version history) for an <code>epi_df</code> object</p>
<p>Archive (data version history) for an <code>epi_df</code> object</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Contains version history for an <code>epi_df</code> object, and enables fast querying of
snapshots of the <code>epi_df</code> object as of certain "issues" (versions). See the
<a href='https://cmu-delphi.github.io/epiprocess/articles/archive.html'>data versioning vignette</a> for
examples.</p>
<p>Version history can be input as a data frame combining full
snapshots of the <code>epi_df</code> as of several issue times, or using only the
newly added or revised rows for each issue, or using some combination of
these two (including "updates" for things that didn't actually
change). Last-observation-carried-forward (LOCF) is used to data in between
recorded updates. Currently, deletions must be represented as revising a
row to a special state (e.g., making the entries <code>NA</code> or including a
special column that flags the data as removed and performing
post-processing), and the archive is unaware of what this state is.</p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<h3>Public methods</h3>

<ul>
<li><p><a href='#method-new'><code>epi_archive$new()</code></a></p></li>
<li><p><a href='#method-epi_df_as_of'><code>epi_archive$epi_df_as_of()</code></a></p></li>
<li><p><a href='#method-naming_info'><code>epi_archive$naming_info()</code></a></p></li>
<li><p><a href='#method-max_issue'><code>epi_archive$max_issue()</code></a></p></li>
<li><p><a href='#method-issues_with_updates'><code>epi_archive$issues_with_updates()</code></a></p></li>
<li><p><a href='#method-update_DT_as_of'><code>epi_archive$update_DT_as_of()</code></a></p></li>
<li><p><a href='#method-clone'><code>epi_archive$clone()</code></a></p></li>
</ul>
<p><hr>
<a id="method-new"></a></p><h3>Method <code>new()</code></h3>
<p>Create a new <code>epi_archive</code> with the given update data</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>epi_archive</span>$<span class='fu'>new</span>(
  <span class='no'>update.df</span>,
  <span class='kw'>issue.colname</span> <span class='kw'>=</span> <span class='st'>"issue"</span>,
  <span class='kw'>geo.colname</span> <span class='kw'>=</span> <span class='st'>"geo_value"</span>,
  <span class='kw'>time.colname</span> <span class='kw'>=</span> <span class='st'>"time_value"</span>,
  <span class='kw'>other.key.colnames</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span>(<span class='fl'>0L</span>),
  <span class='kw'>max.issue</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='no'>update.df</span><span class='kw'>[[</span><span class='no'>issue.colname</span>]])
)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>update.df</code></dt><dd><p>the update data</p></dd>

<dt><code>issue.colname</code></dt><dd><p>name of the column with the issue time of the corresponding updates; operations such as <code>sort</code>, <code>&lt;=</code>, and <code>max</code> must make sense on this column, with earlier issues "less than" later issues</p></dd>

<dt><code>geo.colname</code></dt><dd><p>the name of the column that will become <code>geo_value</code> in the <code>epi_df</code></p></dd>

<dt><code>time.colname</code></dt><dd><p>the name of the column that will become <code>time_value</code> in the <code>epi_df</code></p></dd>

<dt><code>other.key.colnames</code></dt><dd><p>the names of any other columns that would be used to index a single measurement in this data set, such as the age group the measurement corresponds to (if the data set includes an age group breakdown); there should only be a single row per issue-geo-time-other-key-cols combination.</p></dd>

<dt><code>max.issue</code></dt><dd><p>the latest issue for which update data was available; defaults to the maximum issue time in the <code>update.df</code>, but if there were no additions or revisions in subsequent issues, it could be later.  However, due to details regarding database replica syncing times in upstream APIs, using the default might be safer than whatever we think the max issue should be.</p></dd>

</dl><p></div></p>
<h3>Returns</h3>
<p>an <code>epi_archive</code> object</p>
<p><hr>
<a id="method-epi_df_as_of"></a></p><h3>Method <code>epi_df_as_of()</code></h3>
<p>Get the <code>epi_df</code> as of some issue time</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>epi_archive</span>$<span class='fu'>epi_df_as_of</span>(<span class='no'>issue</span>)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>issue</code></dt><dd><p>the desired as-of issue time</p></dd>

</dl><p></div></p>
<h3>Returns</h3>
<p>an <code>epi_df</code> with data as of the specified issue time, <code>issue</code> recorded in the metadata, the geo column renamed to <code>geo_value</code> and time column to <code>time_value</code>, and the other key colnames recorded in the metadata</p>
<p><hr>
<a id="method-naming_info"></a></p><h3>Method <code>naming_info()</code></h3>
<p>Return the name settings in a list</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>epi_archive</span>$<span class='fu'>naming_info</span>()</pre><p></div></p>

<p><hr>
<a id="method-max_issue"></a></p><h3>Method <code>max_issue()</code></h3>
<p>Return the max issue value recorded by this archive (whether it had updates or not)</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>epi_archive</span>$<span class='fu'>max_issue</span>()</pre><p></div></p>

<p><hr>
<a id="method-issues_with_updates"></a></p><h3>Method <code>issues_with_updates()</code></h3>
<p>Return the issue values for which updates are
recorded in this archive (that is, whether they had updates in
the data frame used to form this archive, regardless of whether
those "updates" actually added or revised any data)</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>epi_archive</span>$<span class='fu'>issues_with_updates</span>()</pre><p></div></p>

<p><hr>
<a id="method-update_DT_as_of"></a></p><h3>Method <code>update_DT_as_of()</code></h3>
<p>Return the recorded update data up through the given issue
value, inside a <code>data.table</code> object which is fine to
modify without copying.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>epi_archive</span>$<span class='fu'>update_DT_as_of</span>(<span class='no'>issue</span>)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>issue</code></dt><dd><p>the max issue value that should appear in the result</p></dd>

</dl><p></div></p>
<p><hr>
<a id="method-clone"></a></p><h3>Method <code>clone()</code></h3>
<p>The objects of this class are cloneable with this method.</p><h3>Usage</h3>
<p><div class="r"></p><pre><span class='no'>epi_archive</span>$<span class='fu'>clone</span>(<span class='kw'>deep</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre><p></div></p>

<h3>Arguments</h3>
<p><div class="arguments"></p><dl'>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p></dd>

</dl><p></div></p>



  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Logan Brooks, Evan Ray, Ryan Tibshirani.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


