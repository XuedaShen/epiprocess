<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="An epi_archive is an R6 class which contains a data table
along with several relevant pieces of metadata. The data table can be seen
as the full archive (version history) for some signal variables of
interest."><title>epi_archive object — epi_archive • epiprocess</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="epi_archive object — epi_archive"><meta property="og:description" content="An epi_archive is an R6 class which contains a data table
along with several relevant pieces of metadata. The data table can be seen
as the full archive (version history) for some signal variables of
interest."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-#C41230"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">epiprocess</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.0.9999</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/epiprocess.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/slide.html">Slide a computation over signal values</a>
    <a class="dropdown-item" href="../articles/growth_rate.html">Estimate growth rates in signals</a>
    <a class="dropdown-item" href="../articles/correlation.html">Correlate signals over space and time</a>
    <a class="dropdown-item" href="../articles/aggregation.html">Aggregate signals over space and time</a>
    <a class="dropdown-item" href="../articles/outliers.html">Detect and correct outliers in signals</a>
    <a class="dropdown-item" href="../articles/archive.html">Work with archive objects and data revisions</a>
    <a class="dropdown-item" href="../articles/advanced.html">Advanced sliding with nonstandard outputs</a>
    <a class="dropdown-item" href="../articles/compactify.html">Compactify to remove redundant archive data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cmu-delphi/epiprocess/tree/main/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1><code>epi_archive</code> object</h1>
      <small class="dont-index">Source: <a href="https://github.com/cmu-delphi/epiprocess/blob/main/R/archive.R" class="external-link"><code>R/archive.R</code></a></small>
      <div class="d-none name"><code>epi_archive.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>An <code>epi_archive</code> is an R6 class which contains a data table
along with several relevant pieces of metadata. The data table can be seen
as the full archive (version history) for some signal variables of
interest.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>An <code>epi_archive</code> is an R6 class which contains a data table <code>DT</code>, of
class <code>data.table</code> from the <code>data.table</code> package, with (at least) the
following columns:</p><ul><li><p><code>geo_value</code>: the geographic value associated with each row of measurements.</p></li>
<li><p><code>time_value</code>: the time value associated with each row of measurements.</p></li>
<li><p><code>version</code>: the time value specifying the version for each row of
measurements. For example, if in a given row the <code>version</code> is January 15,
2022 and <code>time_value</code> is January 14, 2022, then this row contains the
measurements of the data for January 14, 2022 that were available one day
later.</p></li>
</ul><p>The data table <code>DT</code> has key variables <code>geo_value</code>, <code>time_value</code>, <code>version</code>,
as well as any others (these can be specified when instantiating the
<code>epi_archive</code> object via the <code>other_keys</code> argument, and/or set by operating
on <code>DT</code> directly). Refer to the documentation for <code><a href="as_epi_archive.html">as_epi_archive()</a></code> for
information and examples of relevant parameter names for an <code>epi_archive</code> object.
Note that there can only be a single row per unique combination of
key variables, and thus the key variables are critical for figuring out how
to generate a snapshot of data from the archive, as of a given version.</p>
<p>In general, the last version of each observation is carried forward (LOCF) to
fill in data between recorded versions, and between the last recorded
update and the <code>versions_end</code>. One consequence is that the <code>DT</code>
doesn't have to contain a full snapshot of every version (although this
generally works), but can instead contain only the rows that are new or
changed from the previous version (see <code>compactify</code>, which does this
automatically). Currently, deletions must be represented as revising a row
to a special state (e.g., making the entries <code>NA</code> or including a special
column that flags the data as removed and performing some kind of
post-processing), and the archive is unaware of what this state is. Note
that <code>NA</code>s <em>can</em> be introduced by <code>epi_archive</code> methods for other reasons,
e.g., in <code><a href="epix_fill_through_version.html">epix_fill_through_version</a></code> and <code><a href="epix_merge.html">epix_merge</a></code>, if requested, to
represent potential update data that we do not yet have access to; or in
<code><a href="epix_merge.html">epix_merge</a></code> to represent the "value" of an observation before the
version in which it was first released, or if no version of that
observation appears in the archive data at all.</p>
<p><strong>A word of caution:</strong> R6 objects, unlike most other objects in R, have
reference semantics. A primary consequence of this is that objects are not
copied when modified. You can read more about this in Hadley Wickham's
<a href="https://adv-r.hadley.nz/r6.html#r6-semantics" class="external-link">Advanced R</a> book. In order
to construct a modified archive while keeping the original intact, first
make a clone using the <code>$clone</code> method, then overwrite the clone's <code>DT</code>
field with <code>data.table::copy(clone$DT)</code>, and finally perform the
modifications on the clone.</p>
    </div>
    <div class="section level2">
    <h2 id="metadata">Metadata<a class="anchor" aria-label="anchor" href="#metadata"></a></h2>
    

<p>The following pieces of metadata are included as fields in an <code>epi_archive</code>
object:</p><ul><li><p><code>geo_type</code>: the type for the geo values.</p></li>
<li><p><code>time_type</code>: the type for the time values.</p></li>
<li><p><code>additional_metadata</code>: list of additional metadata for the data archive.</p></li>
</ul><p>Unlike an <code>epi_df</code> object, metadata for an <code>epi_archive</code> object <code>x</code> can be
accessed (and altered) directly, as in <code>x$geo_type</code> or <code>x$time_type</code>,
etc. Like an <code>epi_df</code> object, the <code>geo_type</code> and <code>time_type</code> fields in the
metadata of an <code>epi_archive</code> object are not currently used by any
downstream functions in the <code>epiprocess</code> package, and serve only as useful
bits of information to convey about the data set at hand.</p>
    </div>
    <div class="section level2">
    <h2 id="generating-snapshots">Generating Snapshots<a class="anchor" aria-label="anchor" href="#generating-snapshots"></a></h2>
    

<p>An <code>epi_archive</code> object can be used to generate a snapshot of the data in
<code>epi_df</code> format, which represents the most up-to-date values of the signal
variables, as of the specified version. This is accomplished by calling the
<code>as_of()</code> method for an <code>epi_archive</code> object <code>x</code>. More details on this
method are documented in the wrapper function <code><a href="epix_as_of.html">epix_as_of()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="sliding-computations">Sliding Computations<a class="anchor" aria-label="anchor" href="#sliding-computations"></a></h2>
    

<p>We can run a sliding computation over an <code>epi_archive</code> object, much like
<code><a href="epi_slide.html">epi_slide()</a></code> does for an <code>epi_df</code> object. This is accomplished by calling
the <code>slide()</code> method for an <code>epi_archive</code> object, which works similarly to
the way <code><a href="epi_slide.html">epi_slide()</a></code> works for an <code>epi_df</code> object, but with one key
difference: it is version-aware. That is, for an <code>epi_archive</code> object, the
sliding computation at any given reference time point t is performed on
<strong>data that would have been available as of t</strong>. More details on <code>slide()</code>
are documented in the wrapper function <code><a href="epix_slide.html">epix_slide()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-epi_archive-new"><code>epi_archive$new()</code></a></p></li>
<li><p><a href="#method-epi_archive-print"><code>epi_archive$print()</code></a></p></li>
<li><p><a href="#method-epi_archive-as_of"><code>epi_archive$as_of()</code></a></p></li>
<li><p><a href="#method-epi_archive-fill_through_version"><code>epi_archive$fill_through_version()</code></a></p></li>
<li><p><a href="#method-epi_archive-truncate_versions_after"><code>epi_archive$truncate_versions_after()</code></a></p></li>
<li><p><a href="#method-epi_archive-merge"><code>epi_archive$merge()</code></a></p></li>
<li><p><a href="#method-epi_archive-group_by"><code>epi_archive$group_by()</code></a></p></li>
<li><p><a href="#method-epi_archive-slide"><code>epi_archive$slide()</code></a></p></li>
<li><p><a href="#method-epi_archive-clone"><code>epi_archive$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-epi_archive-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Creates a new <code>epi_archive</code> object.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/epi_archive.html">epi_archive</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">geo_type</span>,</span>
<span>  <span class="va">time_type</span>,</span>
<span>  <span class="va">other_keys</span>,</span>
<span>  <span class="va">additional_metadata</span>,</span>
<span>  <span class="va">compactify</span>,</span>
<span>  <span class="va">clobberable_versions_start</span>,</span>
<span>  <span class="va">versions_end</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>x</code></dt>
<dd><p>A data frame, data table, or tibble, with columns <code>geo_value</code>,
<code>time_value</code>, <code>version</code>, and then any additional number of columns.</p></dd>


<dt><code>geo_type</code></dt>
<dd><p>Type for the geo values. If missing, then the function will
attempt to infer it from the geo values present; if this fails, then it
will be set to "custom".</p></dd>


<dt><code>time_type</code></dt>
<dd><p>Type for the time values. If missing, then the function will
attempt to infer it from the time values present; if this fails, then it
will be set to "custom".</p></dd>


<dt><code>other_keys</code></dt>
<dd><p>Character vector specifying the names of variables in <code>x</code>
that should be considered key variables (in the language of <code>data.table</code>)
apart from "geo_value", "time_value", and "version".</p></dd>


<dt><code>additional_metadata</code></dt>
<dd><p>List of additional metadata to attach to the
<code>epi_archive</code> object. The metadata will have <code>geo_type</code> and <code>time_type</code>
fields; named entries from the passed list or will be included as well.</p></dd>


<dt><code>compactify</code></dt>
<dd><p>Optional; Boolean or <code>NULL</code>: should we remove rows that are
considered redundant for the purposes of <code>epi_archive</code>'s built-in methods
such as <code>as_of</code>? As these methods use the last version of each observation
carried forward (LOCF) to interpolate between the version data provided,
rows that don't change these LOCF results can potentially be omitted to
save space while maintaining the same behavior (with the help of the
<code>clobberable_versions_start</code> and <code>versions_end</code> fields in some edge cases).
<code>TRUE</code> will remove these rows, <code>FALSE</code> will not, and missing or <code>NULL</code> will
remove these rows and issue a warning. Generally, this can be set to
<code>TRUE</code>, but if you directly inspect or edit the fields of the <code>epi_archive</code>
such as its <code>DT</code>, or rely on redundant updates to achieve a certain
behavior of the <code>ref_time_values</code> default in <code>epix_slide</code>, you will have to
determine whether <code>compactify=TRUE</code> will produce the desired results. If
compactification here is removing a large proportion of the rows, this may
indicate a potential for space, time, or bandwidth savings upstream the
data pipeline, e.g., by avoiding fetching, storing, or processing these
rows of <code>x</code>.</p></dd>


<dt><code>clobberable_versions_start</code></dt>
<dd><p>Optional; as in <code><a href="as_epi_archive.html">as_epi_archive</a></code></p></dd>


<dt><code>versions_end</code></dt>
<dd><p>Optional; as in <code><a href="as_epi_archive.html">as_epi_archive</a></code></p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a></h4>
<p>Refer to the documentation for <code><a href="as_epi_archive.html">as_epi_archive()</a></code> for more information
and examples of parameter names.</p>
</div>

<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>An <code>epi_archive</code> object.</p>
</div>

</div><p></p><hr><a id="method-epi_archive-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>

<div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">epi_archive</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span>class <span class="op">=</span> <span class="cn">TRUE</span>, methods <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-epi_archive-as_of"></a><div class="section">
<h3 id="method-as-of-">Method <code>as_of()</code><a class="anchor" aria-label="anchor" href="#method-as-of-"></a></h3>
<p>Generates a snapshot in <code>epi_df</code> format as of a given version.
See the documentation for the wrapper function <code><a href="epix_as_of.html">epix_as_of()</a></code> for details.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">epi_archive</span><span class="op">$</span><span class="fu">as_of</span><span class="op">(</span><span class="va">max_version</span>, min_time_value <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, all_versions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-epi_archive-fill_through_version"></a><div class="section">
<h3 id="method-fill-through-version-">Method <code>fill_through_version()</code><a class="anchor" aria-label="anchor" href="#method-fill-through-version-"></a></h3>
<p>Fill in unobserved history using requested scheme by mutating
<code>self</code> and potentially reseating its fields. See
<code><a href="epix_fill_through_version.html">epix_fill_through_version</a></code> for a full description of the non-R6-method
version, which doesn't mutate the input archive but might alias its fields.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">epi_archive</span><span class="op">$</span><span class="fu">fill_through_version</span><span class="op">(</span><span class="va">fill_versions_end</span>, how <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"na"</span>, <span class="st">"locf"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>fill_versions_end</code></dt>
<dd><p>as in <code><a href="epix_fill_through_version.html">epix_fill_through_version</a></code></p></dd>


<dt><code>how</code></dt>
<dd><p>as in <code><a href="epix_fill_through_version.html">epix_fill_through_version</a></code></p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-epi_archive-truncate_versions_after"></a><div class="section">
<h3 id="method-truncate-versions-after-">Method <code>truncate_versions_after()</code><a class="anchor" aria-label="anchor" href="#method-truncate-versions-after-"></a></h3>
<p>Filter to keep only older versions, mutating the archive by
potentially reseating but not mutating some fields. <code>DT</code> is likely, but not
guaranteed, to be copied. Returns the mutated archive
<a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisibly</a>.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">epi_archive</span><span class="op">$</span><span class="fu">truncate_versions_after</span><span class="op">(</span><span class="va">max_version</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>max_version</code></dt>
<dd><p>as in <code><a href="epix_truncate_versions_after.html">epix_truncate_versions_after</a></code></p></dd>


<dt><code>x</code></dt>
<dd><p>as in <code><a href="epix_truncate_versions_after.html">epix_truncate_versions_after</a></code></p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-epi_archive-merge"></a><div class="section">
<h3 id="method-merge-">Method <code><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge()</a></code><a class="anchor" aria-label="anchor" href="#method-merge-"></a></h3>
<p>Merges another <code>epi_archive</code> with the current one, mutating the
current one by reseating its <code>DT</code> and several other fields, but avoiding
mutation of the old <code>DT</code>; returns the current archive
<a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisibly</a>. See <code><a href="epix_merge.html">epix_merge</a></code> for a full description
of the non-R6-method version, which does not mutate either archive, and
does not alias either archive's <code>DT</code>.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">epi_archive</span><span class="op">$</span><span class="fu">merge</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  sync <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forbid"</span>, <span class="st">"na"</span>, <span class="st">"locf"</span>, <span class="st">"truncate"</span><span class="op">)</span>,</span>
<span>  compactify <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>y</code></dt>
<dd><p>as in <code><a href="epix_merge.html">epix_merge</a></code></p></dd>


<dt><code>sync</code></dt>
<dd><p>as in <code><a href="epix_merge.html">epix_merge</a></code></p></dd>


<dt><code>compactify</code></dt>
<dd><p>as in <code><a href="epix_merge.html">epix_merge</a></code></p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-epi_archive-group_by"></a><div class="section">
<h3 id="method-group-by-">Method <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code><a class="anchor" aria-label="anchor" href="#method-group-by-"></a></h3>

<div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">epi_archive</span><span class="op">$</span><span class="fu">group_by</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  .add <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .drop <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by_drop_default.html" class="external-link">group_by_drop_default</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-epi_archive-slide"></a><div class="section">
<h3 id="method-slide-">Method <code>slide()</code><a class="anchor" aria-label="anchor" href="#method-slide-"></a></h3>
<p>Slides a given function over variables in an <code>epi_archive</code>
object. See the documentation for the wrapper function <code><a href="epix_slide.html">epix_slide()</a></code> for
details.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">epi_archive</span><span class="op">$</span><span class="fu">slide</span><span class="op">(</span></span>
<span>  <span class="va">f</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">before</span>,</span>
<span>  <span class="va">ref_time_values</span>,</span>
<span>  <span class="va">time_step</span>,</span>
<span>  new_col_name <span class="op">=</span> <span class="st">"slide_value"</span>,</span>
<span>  as_list_col <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  all_versions <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-epi_archive-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">epi_archive</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">tib</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  geo_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ca"</span>, <span class="st">"hi"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  time_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                       by <span class="op">=</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  version <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-02"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                    by <span class="op">=</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">toy_epi_archive</span> <span class="op">&lt;-</span> <span class="va">tib</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="va">epi_archive</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>geo_type <span class="op">=</span> <span class="st">"state"</span>, </span></span>
<span class="r-in"><span>                                           time_type <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">toy_epi_archive</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An `epi_archive` object, with metadata:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * geo_type  = state</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * time_type = day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * min time value = 2020-01-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * max time value = 2020-01-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * first version with update = 2020-01-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * last version with update = 2020-01-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * No clobberable versions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * versions end   = 2020-01-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data archive (stored in DT field): 10 x 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Columns in DT: geo_value, time_value, version, value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Public R6 methods: initialize, print, as_of, fill_through_version, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    truncate_versions_after, merge, group_by, slide, clone</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Logan Brooks, Daniel McDonald, Evan Ray, Ryan Tibshirani.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

